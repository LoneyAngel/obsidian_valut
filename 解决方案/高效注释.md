## 1. 注释不应重复代码

许多初学者因为在入门课程中被教导写注释，结果往往在代码的每个大括号后面都加上注释，标明块的结束位置：

```go
if x > 3 {
   // some code
} // if
```

这样的注释增加了视觉混乱，耗费了编写和阅读的时间，并且容易过时。典型的坏例子是：

```go
i = i + 1 // 将i加1
```

这样的注释没有提供任何有用的信息，反而增加了维护成本。

## 2. 好的注释不能成为写不清楚代码的借口

注释应该提供代码中没有的背景信息。例如，使用单字母变量名并添加注释来说明它的用途：

```go
func getBestChildNode(node *Node) *Node {
    var n *Node // 最佳子节点候选者
    for _, child := range node.Children {
        // 如果当前状态更好则更新n
        if n == nil || utility(child) > utility(n) {
            n = child
        }
    }
    return n
}
```

通过更清晰的变量命名，可以避免使用注释：

```go
func getBestChildNode(node *Node) *Node {
    var bestNode *Node
    for _, currentNode := range node.Children {
        if bestNode == nil || utility(currentNode) > utility(bestNode) {
            bestNode = currentNode
        }
    }
    return bestNode
}
```

正如《编程风格要素》中的 Kernighan 和 Plauger 所说：“不要为糟糕的代码写注释——重写它。”

## 3. 如果无法写出清晰的注释，可能是代码本身存在问题

Unix 源码中有一句最臭名昭著的注释是“你不需要理解这段代码”，这段注释出现在复杂的上下文切换代码之前。Dennis Ritchie 后来解释说，这注释的本意是“这段代码不会出现在考试中”，而不是挑衅。不幸的是，连他和合著者 Ken Thompson 自己也没能理解这段代码，最终不得不重写。

这让人想起 Kernighan 的法则：

> Debugging is twice as hard as writing the code in the first place. Therefore, if you write the code as cleverly as possible, you are, by definition, not smart enough to debug it.

调试代码的难度是编写代码的两倍。因此，如果你尽可能聪明地编写代码，那么从定义上来说，你就无法足够聪明地来调试它。

## 4. 注释应消除困惑，而非制造困惑

Steven Levy 的《黑客：计算机革命的英雄》讲述了一个故事：

> Peter Samson 拒绝在他的源代码中添加解释当前操作的注释。他写的一个包含数百条汇编指令的程序只有一个注释，注释内容是 RIPJSB，而这一指令的值是 1750。有人绞尽脑汁试图理解其含义，直到有人发现 1750 是巴赫去世的年份，而 RIPJSB 是“愿约翰·塞巴斯蒂安·巴赫安息”的缩写。

尽管这样的注释令人印象深刻，但并不是一个好的示范。如果注释只会引起混淆而不是消除困惑，就应该将其删除。

## 5. 解释非惯用代码

注释应解释那些其他人可能认为不必要或冗余的代码，例如：

```go
value := (new JSONTokener(jsonString)).nextValue()
// JSONTokener.nextValue() 可能返回一个等于 null 的值。
if value == nil || value == interface{}(nil) {
    return nil
}
```

如果没有注释，某人可能会“简化”代码或将其视为神秘但必需的咒语。通过编写注释来说明代码的必要性，为后续读者节省时间和精力。

判断代码是否需要解释时需慎重。如果是常见的惯用法，无需注释，除非是写给新手的教程。

## 6. 提供复制代码的原始来源链接

许多程序员会使用网上找到的代码。提供来源可以让后续读者获取完整的上下文，例如：

```go
// 将 Drawable 转换为 Bitmap，代码来自 https://stackoverflow.com/a/46018816/2219998。
```

通过链接，读者可以了解代码作者是谁，背景是什么，评论者的建议等。避免让读者自己去搜索公式或代码，直接粘贴 URL 更为方便。

在复制代码时，应理解其含义，避免直接粘贴不理解的代码。

## 7. 在最有帮助的地方包含外部引用链接

不仅是 Stack Overflow 的链接，标准文档等也应在适当的位置引用：

```go
// http://tools.ietf.org/html/rfc4180 建议CSV行应以CRLF结尾，因此使用 \r\n。
csvStringBuilder.WriteString("\r\n")
```

这些链接帮助读者理解代码解决的问题，设计文档中的信息也应在需要时通过注释指明。

## 8. 修复 bug 时添加注释

不仅在编写代码时要添加注释，修改代码尤其是修复 bug 时也应添加注释。例如：

```go
// 注意：在 Firefox 2 中，如果用户将鼠标拖出浏览器窗口，则不会接收到 mouse-move（甚至 mouse-down）事件，
// 直到用户将鼠标拖回窗口内。onMouseLeave() 方法实现了一个变通方法来解决这个问题。
func onMouseMove(sender *Widget, x, y int) {
    // 实现代码
}
```

这样的注释有助于理解当前和相关方法中的代码，也有助于判断代码是否仍然需要以及如何进行测试。

也可以参考 Issue 跟踪器：

```go
// 如果属性中没有标题，则使用名称作为标题（Issue #1425）
```

## 9. 用注释标记未完成的实现

有时需要提交代码，即使它还有已知的不足之处。为了明确这些不足，可以使用 TODO 注释来标记，例如：

```go
// TODO: 目前我们只支持使用点号作为小数分隔符，未来需要支持逗号作为小数分隔符，
// 这将需要更新数字解析和其他将数字转换为字符串的地方，例如 FormatAsDecimal。
```

使用标准格式的注释有助于度量和解决技术债务。最好在 Issue 跟踪器中添加问题，并在注释中引用问题。


## 10. 在有处理逻辑的代码中，源程序有效注释量必须在20％以上。

说明：注释的原则是有助于对程序的阅读理解，在该加的地方都加了，注释不宜太多也不能太少，注释语言必须准确、易懂、简洁。

## 11. 文件注释：文件注释写入文件头部。

说明：以/* 开始

示例：

```cpp
/ * * 文件名：[文件名] * 作者：〈版权〉 * 描述：〈描述〉 * 修改人：〈修改人〉 * 修改时间：YYYY-MM-DD  * 修改内容：〈修改内容〉  */
```

说明：每次修改后在文件头部写明修改信息。

示例：

```cobol
/ * * 文件名：LogManager.java * 版权：Copyright 2000-2001 Huawei Tech. Co. Ltd.  All Rights Reserved. * 描述： WIN V200R002 WEBSMAP 通用日志系统 * 修改人：张三 * 修改时间：2001-02-16 * 修改内容：新增 * 修改人：李四 * 修改时间：2001-02-26 * 修改内容：。。。。。。 * 修改人：王五 * 修改时间：2001-03-25 * 修改内容：。。。。。。  */
```

## 12. 类和接口的注释：该注释放在class定义之前，using或package关键字之后。

示例：

```cobol
package com. websmap.comm; /**  * 注释内容  */ public class CommManager
```

## 13. 类和接口的注释内容：类的注释主要是一句话功能简述、功能详细描述

说明：可根据需要列出：版本号、生成日期、作者、内容、功能、与其它类的关系等。

格式：

```cobol
/ *  * 〈一句话功能简述〉 * 〈功能详细描述〉 * @author [作者] * @version [版本号, YYYY-MM-DD] * @see [相关类/方法] * @since [产品/模块版本] * @deprecated */
```

说明：描述部分说明该类或者接口的功能、作用、使用方法和注意事项，每次修改后增加作者和更新版本号和日期，@since 表示从那个版本开始就有这个类或者接口，@deprecated 表示不建议使用该类或者接口。

示例：

```cobol
/ * * LogManager 类集中控制对日志读写的操作。 *全部为静态变量和静态方法，对外提供统一接口。分配对应日志类型的读写器，读取或写入符合条件的日志纪录。 * @author 张三，李四，王五 * @version 1.2, 2001-03-25 * @see LogIteraotor * @see BasicLog * @since CommonLog1.0 */
```

##   
5.类属性、公有和保护方法注释：写在类属性、公有和保护方法上面。用//来注释,需要对齐被注释代码。

示例：

```cobol
/ /注释内容 private  String logType
```

## 14. 成员变量注释内容：成员变量的意义、目的、功能，可能被用到的地方。用//来注释,需要对齐被注释代码

## 15. 公有和保护方法注释内容：列出方法的一句话功能简述、功能详细描述、输入参数、输出参数、返回值、违例等。  
格式：

```cobol
/ ** *〈一句话功能简述〉 *〈功能详细描述〉 * @param [参数1] [参数1说明] * @param [参数2] [参数2说明] * @return [返回类型说明] * @exception/throws [违例类型] [违例说明] * @see [类、类#方法、类#成员]  * @deprecated */
```

说明：@since 表示从那个版本开始就有这个方法；@exception或throws 列出可能出现的[异常](https://marketing.csdn.net/p/3127db09a98e0723b83b2914d9256174?pId=2782&utm_source=glcblog&spm=1001.2101.3001.7020)；@deprecated 表示不建议使用该方法。

## 16. 对于方法内部用throw语句抛出的异常，必须在方法的注释中标明，对于所调用的其他方法所抛出的异常，选择主要的在注释中说明。对于非RuntimeException ，即throws子句声明会抛出的异常，必须在方法的注释中标明。

说明：

异常注释用@exception或@throws表示，在JavaDoc中两者等价，但推荐用@exception标注Runtime 异常，@throws标注非Runtime 异常。异常的注释必须说明该异常的含义及什么条件下抛出该异常。

## 17. 注释应与其描述的代码相近，对代码的注释应放在其上方或右方（对单条语句的注释）相邻位置，不可放在下面，如放于上方则需与其上面的代码用空行隔开。

## 18. 注释的排版，按照上述示例来展示。

## 19. 注释应该放在被注释的代码前面，分行展示，但中间不留空行。

## 20. 对变量的定义和分支语句（条件分支、循环语句等）必须编写注释。

说明：分支语句往往是程序实现某一特定功能的关键。

## 21. 边写代码边注释，修改代码同时修改相应的注释，以保证注释与代码的一致性。不再有用的注释要删除。

## 22. 注释的内容要清楚、明了，含义准确，防止注释二义性。说明：错误的注释不但无益反而有害。

## 23. 避免在注释中使用缩写，特别是不常用缩写。说明：在使用缩写时或之前，应对缩写进行必要的说明。